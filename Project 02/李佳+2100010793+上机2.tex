\documentclass{article}
\usepackage{graphicx}
\usepackage[UTF8]{ctex}
% \usepackage[showframe]{geometry} %调整页边距showframe显示框架
\usepackage{amsmath}  %数学环境
\usepackage{paralist,bbding,pifont} %罗列环境
\usepackage{lmodern}  %中文环境与amsmath格式冲突
\usepackage{array,graphicx}  %插入表格、图片
\usepackage{float}
\usepackage{appendix}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{tocloft}  %目录
\usepackage{listings}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{setspace}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{tikz}
%\documentclass[tikz]{stanalone}	% 
\usepackage{pgfplots}	
\pgfplotsset{compat=newest}
\renewcommand\cftsecdotsep{\cftdotsep}
\renewcommand\cftsecleader{\cftdotfill{\cftsecdotsep}}
\renewcommand {\cftdot}{$ \cdot $}
\renewcommand {\cftdotsep}{1.5}
\hypersetup{colorlinks=true,linkcolor=black}
\usepackage[a4paper, portrait, margin=2.5cm]{geometry}
\renewcommand{\baselinestretch}{1.25} %行间距取多倍行距（设置值为1.5）
\setlength{\baselineskip}{20pt} 

%% 页眉
\usepackage{fancyhdr}
\newcommand{\myname}{李佳}
\newcommand{\myid}{2100010793}
\pagestyle{fancy}
\fancyhf{}
\rhead{\myid}
\lhead{\myname}
\cfoot{\thepage}

%%%% Declare %%%
\DeclareMathOperator{\Ran}{Ran}
\DeclareMathOperator{\Dom}{Dom}
\DeclareMathOperator{\Rank}{Rank}

\newcommand{\md}{\mathrm{d}}
\newcommand{\mR}{\mathbb{R}}
\newcommand{\mbF}{\mathbb{F}}
%%% Declare %%%
\newtheorem{innercustomthm}{Problem}
\newenvironment{prob}[1]
{\renewcommand\theinnercustomthm{#1}\innercustomthm}
{\endinnercustomthm}

%%设置
\title{\textbf{数值分析$\ $上机作业2}}
\author{李佳~2100010793}
\date{}

%%正文
\begin{document}
\zihao{-4}
\maketitle
(选择作业B)
\begin{section}{问题描述}
    用不同的数值积分法(复合中点、复合梯形、复合Simpson、Romberg求积方法、自适应方法)计算
    $$\int_0^1\frac{4}{1+x^2}\,dx\ \ (=\pi),$$
    并数值估计收敛阶.
\end{section}
\begin{section}{算法描述}
\begin{subsection}{复合中点公式}
    中点公式使用常值多项式近似函数以求积分值的近似:
    $$\int_a^b f(x)\,dx \approx (b-a)f(\frac{a+b}{2}),$$
    复合中点公式将积分区间分为若干小段, 最长的区间长度为$h$, 分段应用中点公式近似积分, 近似值记为$M(h)$. 其误差估计为
    $$|\int_a^b f(x)\,dx - M(h)|\leq \frac{h^2}{24}M_2(b-a),$$
    其中$M_2=\max\{|f''(x)|:x\in[a,b]\}$.
\end{subsection}
\begin{subsection}{复合梯形公式}
    梯形公式使用一次多项式近似函数以求积分值的近似:
    $$\int_a^b f(x)\,dx \approx (b-a)\frac{f(a)+f(b)}{2},$$
    复合梯形公式将积分区间分为若干小段, 最长的区间长度为$h$, 分段应用梯形公式近似积分, 近似值记为$T(h)$. 其误差估计为
    $$|\int_a^b f(x)\,dx - T(h)|\leq \frac{h^2}{12}M_2(b-a),$$
    其中$M_2=\max\{|f''(x)|:x\in[a,b]\}$.
\end{subsection}
\begin{subsection}{复合Simpson公式}
    Simpson公式使用二次多项式近似函数以求积分值的近似:
    $$\int_a^b f(x)\,dx \approx \frac{b-a}{6}(f(a) + f(b) + 4f(\frac{a+b}{2})),$$
    复合Simpson公式将积分区间分为若干小段, 最长的区间长度为$h$, 分段应用Simpson公式近似积分, 近似值记为$S(h)$. 其误差估计为
    $$|\int_a^b f(x)\,dx - S(h)|\leq \frac{h^4}{2880}M_4(b-a),$$
    其中$M_4=\max\{|f^{(4)}(x)|:x\in[a,b]\}$.
\end{subsection}
\begin{subsection}{Romberg求积方法}
    Romberg求积方法通过使用Euler-Maclaurin公式, 对低阶格式作线性组合得到高阶格式. 
    具体是递推地计算$R_{k+1}(h)=(4^{k}R_{k}(h/2)-R_{k}(h))/(4^{k}-1)$得到高阶格式, 
    其中$R_k(h)$是误差为$O(h^{2k})$的近似公式.
\end{subsection}
\begin{subsection}{自适应方法}
    自适应方法是根据函数的具体形式来确定求积节点的数值积分方法. 主要思想是: 若近似积分的误差近似地超过某标准(例如误差等分布原则), 则对区间加细以得到更小误差的近似积分值. 
    近似误差的计算方法为(以Simpson公式为例): 记区间$[u,v]$上Simpson公式得到的近似值为$S(u,v)$, 令$w=\frac{u+v}{2}$, 有结果(课上已讲):
    $$\int_u^v f(x)\,dx\approx S(u,w)+S(w,v) + \frac{1}{15}(S(u,w)+S(w,v)-S(u,v)),$$
    即误差近似为\begin{equation}\bigg|\frac{1}{15}(S(u,w)+S(w,v)-S(u,v))\bigg|\label{error}\end{equation}
    
    具体实现中, 先设置误差阈值$\varepsilon$, 将整段区间$[a,b]$分为三类区间: 已完成计算的区间$S$(Safe), 
    正在自适应的区间$A$(Active), 未处理的区间$N$(Not Examined). 记$S$上得到的数值积分为$I_S(f)$.
    初始化$S=N=\varnothing, A=[a,b] $. 将\eqref{error}中的系数改为$1/10$(误差是估计值不准确, 因此增大系数以加强判定的条件)后按该公式计算$A=[\alpha,\beta]$上数值积分的近似误差$e_A$, 

    \noindent 1. 若$e_A<\varepsilon \frac{\beta-\alpha}{b-a}$, 即通过检验. 记$A$的中点$\gamma$, 则$I_S(f)\leftarrow I_S(f)+S(\alpha,\gamma)+S(\gamma,\beta)$, $S\leftarrow S\cup A$, $A\leftarrow N$;

    \noindent 2. 若未通过检验, 则区间折半, $A\leftarrow [\alpha,\gamma]$, $N\leftarrow N\cup [\gamma,\beta]$, 重新计算$A$上数值积分的近似误差并返步1.
\end{subsection}
\end{section}

\begin{section}{计算结果}
    对复合中点公式、复合梯形公式、复合Simpson公式、Romberg方法数值估计收敛阶, 因此计算误差后, 除以对应的收敛阶再作图, 验证其是否大致为O(1) (例如对中点公式, 误差$e\sim O(h^2)$, 因此计算$e/h^2=n^2\cdot e$随$n$的变化图).

    对自适应方法, 其本身就需要设置一个误差的阈值, 因此没有必要数值估计收敛阶, 仅呈现若干数值算例的结果.

    \begin{figure}[!htbp]
        \centering
    \begin{tikzpicture}[]
        \begin{axis}[ xlabel=等分区间个数$n$,  ylabel=$n^2\cdot|M(h)-\pi|$, ymin = 0.0832,ymax = 0.0834,ytick={8.32e-2,8.33e-2,8.34e-2}] % sharp plot: 折线图，通过修改此类型，即可完成多种图形绘制
            \addplot[mark=.,blue] coordinates{
                %( 6 , 0.08333185077521144 ) ( 12 , 0.08333324064050629 ) ( 18 , 0.08333331502323027 ) ( 24 , 0.08333332753937839 ) ( 30 , 0.08333333096137707 ) ( 36 , 0.0833333321888432 ) ( 42 , 0.08333333271471055 ) ( 48 , 0.08333333297196077 ) ( 54 , 0.08333333310754831 ) ( 60 , 0.0833333331812014 ) ( 66 , 0.08333333322817182 ) ( 72 , 0.08333333325589365 ) ( 78 , 0.08333333328390324 ) ( 84 , 0.08333333329675696 ) ( 90 , 0.08333333330510229 ) ( 96 , 0.08333333330347159 ) ( 102 , 0.0833333333120887 ) ( 108 , 0.08333333333416704 ) ( 114 , 0.08333333333880333 ) ( 120 , 0.08333333330909909 ) ( 126 , 0.08333333331790804 ) ( 132 , 0.08333333332489445 ) ( 138 , 0.08333333333181692 ) ( 144 , 0.0833333332973325 ) ( 150 , 0.08333333335386328 ) ( 156 , 0.08333333330551795 ) ( 162 , 0.08333333338337567 ) ( 168 , 0.08333333335002635 ) ( 174 , 0.0833333332649584 ) ( 180 , 0.08333333331229653 ) ( 186 , 0.08333333328430292 ) ( 192 , 0.08333333329937886 ) ( 198 , 0.08333333341387927 ) ( 204 , 0.08333333333519022 ) ( 210 , 0.08333333325993841 ) ( 216 , 0.08333333335488646 ) ( 222 , 0.08333333340073779 ) ( 228 , 0.08333333325800396 ) ( 234 , 0.0833333334135915 ) ( 240 , 0.08333333352652517 ) ( 246 , 0.08333333341307991 ) ( 252 , 0.08333333343776417 ) ( 258 , 0.08333333337754034 ) ( 264 , 0.08333333351833971 ) ( 270 , 0.08333333323315983 ) ( 276 , 0.08333333318804392 ) ( 282 , 0.08333333341982652 ) ( 288 , 0.08333333316841163 ) ( 294 , 0.08333333335786008 ) ( 300 , 0.08333333331389525 ) 
                ( 5 , 0.08333026033837676 ) ( 10 , 0.08333314113047052 ) ( 15 , 0.08333329536575063 ) ( 20 , 0.08333332131993387 ) ( 25 , 0.08333332841281571 ) ( 30 , 0.08333333096137707 ) ( 35 , 0.0833333320516938 ) ( 40 , 0.08333333258292441 ) ( 45 , 0.08333333286445477 ) ( 50 , 0.08333333302634749 ) ( 55 , 0.0833333331229591 ) ( 60 , 0.0833333331812014 ) ( 65 , 0.0833333332290409 ) ( 70 , 0.0833333332534103 ) ( 75 , 0.08333333327642523 ) ( 80 , 0.08333333329062498 ) ( 85 , 0.08333333329758608 ) ( 90 , 0.08333333330510229 ) ( 95 , 0.08333333329744175 ) ( 100 , 0.08333333329613168 ) ( 105 , 0.08333333330889925 ) ( 110 , 0.0833333333459585 ) ( 115 , 0.08333333332265491 ) ( 120 , 0.08333333330909909 ) ( 125 , 0.08333333335192039 ) ( 130 , 0.08333333334724635 ) ( 135 , 0.08333333331409509 ) ( 140 , 0.08333333330128312 ) ( 145 , 0.08333333334189508 ) ( 150 , 0.08333333335386328 ) ( 155 , 0.08333333333807591 ) ( 160 , 0.08333333333894188 ) ( 165 , 0.08333333336745241 ) ( 170 , 0.08333333337779969 ) ( 175 , 0.08333333333609971 ) ( 180 , 0.08333333331229653 ) ( 185 , 0.08333333335027726 ) ( 190 , 0.08333333335355242 ) ( 195 , 0.08333333324405112 ) ( 200 , 0.08333333326504544 ) ( 205 , 0.08333333332051218 ) ( 210 , 0.08333333325993841 ) ( 215 , 0.08333333337015025 ) ( 220 , 0.08333333335670545 ) ( 225 , 0.08333333331139725 ) ( 230 , 0.08333333338725879 ) ( 235 , 0.0833333334649522 ) ( 240 , 0.08333333352652517 ) ( 245 , 0.08333333343782945 ) ( 250 , 0.08333333337273707 ) ( 255 , 0.08333333321737246 ) ( 260 , 0.0833333335949149 ) ( 265 , 0.08333333344541227 ) ( 270 , 0.08333333323315983 ) ( 275 , 0.08333333334192838 ) ( 280 , 0.0833333334057329 ) ( 285 , 0.0833333331050623 ) ( 290 , 0.08333333332322113 ) ( 295 , 0.0833333333524644 ) ( 300 , 0.08333333331389525 ) ( 305 , 0.08333333334976656 ) ( 310 , 0.08333333344476834 ) ( 315 , 0.08333333324035408 ) ( 320 , 0.08333333316841163 ) ( 325 , 0.08333333317650515 ) ( 330 , 0.0833333336576203 ) ( 335 , 0.08333333322259051 ) ( 340 , 0.0833333334933073 ) ( 345 , 0.08333333344598959 ) ( 350 , 0.0833333334993025 ) ( 355 , 0.08333333324900272 ) ( 360 , 0.08333333299574974 ) ( 365 , 0.08333333365938556 ) ( 370 , 0.08333333339587412 ) ( 375 , 0.08333333348375938 ) ( 380 , 0.08333333378640617 ) ( 385 , 0.08333333387793296 ) ( 390 , 0.08333333309207269 ) ( 395 , 0.08333333320925673 ) ( 400 , 0.08333333369137108 ) ( 405 , 0.08333333390492248 ) ( 410 , 0.08333333399237475 ) ( 415 , 0.08333333314881619 ) ( 420 , 0.08333333324035408 ) ( 425 , 0.08333333384624719 ) ( 430 , 0.08333333363701456 ) ( 435 , 0.0833333337153741 ) ( 440 , 0.08333333378658381 ) ( 445 , 0.08333333299085366 ) ( 450 , 0.08333333315402314 ) ( 455 , 0.08333333305267088 ) ( 460 , 0.08333333357519734 ) ( 465 , 0.08333333372216867 ) ( 470 , 0.08333333292540601 ) ( 475 , 0.08333333414711763 ) ( 480 , 0.08333333337304794 ) ( 485 , 0.08333333363336193 ) ( 490 , 0.083333333997615 ) ( 495 , 0.08333333267830367 ) ( 500 , 0.08333333267884768 ) ( 505 , 0.08333333380858843 ) ( 510 , 0.08333333373715668 ) ( 515 , 0.08333333346808303 ) ( 520 , 0.0833333332046493 ) ( 525 , 0.08333333355370343 ) ( 530 , 0.0833333328840613 ) ( 535 , 0.08333333368961693 ) ( 540 , 0.08333333342740445 ) ( 545 , 0.08333333324450631 ) ( 550 , 0.08333333209931126 ) ( 555 , 0.08333333319828773 ) ( 560 , 0.08333333277903421 ) ( 565 , 0.08333333363059747 ) ( 570 , 0.08333333361005835 ) ( 575 , 0.08333333366916662 ) ( 580 , 0.08333333384609176 ) ( 585 , 0.08333333226463457 ) ( 590 , 0.08333333373893304 ) ( 595 , 0.08333333346122185 ) ( 600 , 0.08333333207488636 ) ( 605 , 0.08333333427960055 ) ( 610 , 0.08333333306058677 ) ( 615 , 0.08333333451493452 ) ( 620 , 0.08333333331673742 ) ( 625 , 0.08333333363641504 ) ( 630 , 0.08333333517920316 ) ( 635 , 0.08333333346929317 ) ( 640 , 0.08333333444170421 ) ( 645 , 0.08333333281589361 ) ( 650 , 0.08333333256671516 ) ( 655 , 0.08333333191118397 ) ( 660 , 0.0833333336576203 ) ( 665 , 0.08333333405092791 ) ( 670 , 0.08333333023231582 ) ( 675 , 0.0833333333788433 ) ( 680 , 0.08333333282593003 ) ( 685 , 0.08333333438331758 ) ( 690 , 0.08333333397456677 ) ( 695 , 0.08333333451540081 ) ( 700 , 0.08333333572974055 ) ( 705 , 0.08333333358757633 ) ( 710 , 0.08333333308110369 ) ( 715 , 0.08333333570760271 ) ( 720 , 0.08333333362884332 ) ( 725 , 0.08333333341659088 ) ( 730 , 0.08333333324523906 ) ( 735 , 0.08333333407758436 ) ( 740 , 0.083333333760649 ) ( 745 , 0.0833333341405007 ) ( 750 , 0.08333333223475847 ) ( 755 , 0.08333333266172804 ) ( 760 , 0.08333333385053265 ) ( 765 , 0.08333332946337535 ) ( 770 , 0.08333333282473099 ) ( 775 , 0.08333333362614548 ) ( 780 , 0.08333333491581385 ) ( 785 , 0.08333333690009326 ) ( 790 , 0.08333333327854575 ) ( 795 , 0.08333333590911929 ) ( 800 , 0.08333333568089074 ) ( 805 , 0.0833333337337705 ) ( 810 , 0.08333333281229649 ) ( 815 , 0.08333333204397775 ) ( 820 , 0.08333333354446637 ) ( 825 , 0.08333333287174893 ) ( 830 , 0.08333333475496474 ) ( 835 , 0.08333333404608734 ) ( 840 , 0.08333333347536609 ) ( 845 , 0.08333333320089675 ) ( 850 , 0.08333333240240215 ) ( 855 , 0.08333333227542594 ) ( 860 , 0.08333333199477266 ) ( 865 , 0.08333333633322448 ) ( 870 , 0.08333333489183303 ) ( 875 , 0.08333333120086328 ) ( 880 , 0.08333333774146467 ) ( 885 , 0.08333333404810794 ) ( 890 , 0.08333333272703136 ) ( 895 , 0.08333333440785351 ) ( 900 , 0.08333333387344766 ) ( 905 , 0.08333333207647398 ) ( 910 , 0.08333333498335982 ) ( 915 , 0.08333333223435879 ) ( 920 , 0.08333333225962747 ) ( 925 , 0.083333330188895 ) ( 930 , 0.08333333468240056 ) ( 935 , 0.0833333359574695 ) ( 940 , 0.08333333567218659 ) ( 945 , 0.08333333156589351 ) ( 950 , 0.08333332953802675 ) ( 955 , 0.08333333219078254 ) ( 960 , 0.0833333323498664 ) ( 965 , 0.08333333512685615 ) ( 970 , 0.08333333123076159 ) ( 975 , 0.08333333275434285 ) ( 980 , 0.08333333527712483 ) ( 985 , 0.08333333057949366 ) ( 990 , 0.08333333583387947 ) ( 995 , 0.08333333751788796 ) ( 1000 , 0.08333333756382899 ) 
                };\label{plot_one}
        \end{axis}
    \end{tikzpicture}
    \caption{复合中点公式下$n^2\cdot|M(h)-\pi|$关于$n$的变化图}
    \end{figure}
        
    \begin{figure}[!htbp]
        \centering
    \begin{tikzpicture}[]
        \begin{axis}[ xlabel=等分区间个数$n$,  ylabel=$n^2\cdot|T(h)-\pi|$,ymin=0.16,ymax=0.18,ytick={0.160,0.170,0.180}] % sharp plot: 折线图，通过修改此类型，即可完成多种图形绘制
            \addplot[mark=.,blue] coordinates{
                %( 6 , 0.16666513626708834 ) ( 12 , 0.16666657098372184 ) ( 18 , 0.16666664776603035 ) ( 24 , 0.1666666606863032 ) ( 30 , 0.16666666421731868 ) ( 36 , 0.16666666548387354 ) ( 42 , 0.16666666602870173 ) ( 48 , 0.16666666628873372 ) ( 54 , 0.16666666643783046 ) ( 60 , 0.16666666650948514 ) ( 66 , 0.16666666656660745 ) ( 72 , 0.16666666659006069 ) ( 78 , 0.16666666660833407 ) ( 84 , 0.16666666663424934 ) ( 90 , 0.16666666664977292 ) ( 96 , 0.16666666665196317 ) ( 102 , 0.1666666666426586 ) ( 108 , 0.16666666666315422 ) ( 114 , 0.1666666666602925 ) ( 120 , 0.16666666664377772 ) ( 126 , 0.16666666664286645 ) ( 132 , 0.16666666667300234 ) ( 138 , 0.16666666664671936 ) ( 144 , 0.1666666666775427 ) ( 150 , 0.16666666667775054 ) ( 156 , 0.16666666666507268 ) ( 162 , 0.16666666667351393 ) ( 168 , 0.1666666666499168 ) ( 174 , 0.16666666669125973 ) ( 180 , 0.16666666669653551 ) ( 186 , 0.1666666666454244 ) ( 192 , 0.16666666656601592 ) ( 198 , 0.16666666674070818 ) ( 204 , 0.16666666668886165 ) ( 210 , 0.1666666666765515 ) ( 216 , 0.16666666662689522 ) ( 222 , 0.1666666667358161 ) ( 228 , 0.1666666666314356 ) ( 234 , 0.16666666665696717 ) ( 240 , 0.1666666666949368 ) ( 246 , 0.16666666671866182 ) ( 252 , 0.1666666666499168 ) ( 258 , 0.16666666672552033 ) ( 264 , 0.16666666644860584 ) ( 270 , 0.16666666656344198 ) ( 276 , 0.16666666681586406 ) ( 282 , 0.16666666676902153 ) ( 288 , 0.16666666663149954 ) ( 294 , 0.16666666686926135 ) ( 300 , 0.16666666654785445 ) 
                ( 5 , 0.16666349447007622 ) ( 10 , 0.16666646826344333 ) ( 15 , 0.16666662747440997 ) ( 20 , 0.16666665426541272 ) ( 25 , 0.16666666158737797 ) ( 30 , 0.16666666421731868 ) ( 35 , 0.16666666534481678 ) ( 40 , 0.16666666589273404 ) ( 45 , 0.16666666618484482 ) ( 50 , 0.16666666635023475 ) ( 55 , 0.16666666644876704 ) ( 60 , 0.16666666650948514 ) ( 65 , 0.1666666665575245 ) ( 70 , 0.16666666658515794 ) ( 75 , 0.1666666666078065 ) ( 80 , 0.16666666661251384 ) ( 85 , 0.16666666663688323 ) ( 90 , 0.16666666664977292 ) ( 95 , 0.16666666663897045 ) ( 100 , 0.1666666666233496 ) ( 105 , 0.166666666647175 ) ( 110 , 0.1666666666381822 ) ( 115 , 0.16666666665705598 ) ( 120 , 0.16666666664377772 ) ( 125 , 0.16666666664139074 ) ( 130 , 0.16666666666447227 ) ( 135 , 0.16666666666865781 ) ( 140 , 0.16666666668090357 ) ( 145 , 0.1666666666651162 ) ( 150 , 0.16666666667775054 ) ( 155 , 0.16666666661213636 ) ( 160 , 0.16666666662104035 ) ( 165 , 0.16666666658982088 ) ( 170 , 0.1666666666914285 ) ( 175 , 0.1666666666177985 ) ( 180 , 0.16666666669653551 ) ( 185 , 0.16666666662455976 ) ( 190 , 0.16666666670710484 ) ( 195 , 0.16666666674139963 ) ( 200 , 0.166666666689963 ) ( 205 , 0.16666666658503582 ) ( 210 , 0.1666666666765515 ) ( 215 , 0.1666666666581884 ) ( 220 , 0.16666666675639874 ) ( 225 , 0.16666666669024055 ) ( 230 , 0.16666666675102526 ) ( 235 , 0.16666666651298234 ) ( 240 , 0.1666666666949368 ) ( 245 , 0.1666666666890637 ) ( 250 , 0.16666666666220742 ) ( 255 , 0.16666666666576013 ) ( 260 , 0.1666666666794825 ) ( 265 , 0.16666666661014906 ) ( 270 , 0.16666666656344198 ) ( 275 , 0.16666666671744101 ) ( 280 , 0.16666666660256624 ) ( 285 , 0.16666666685940523 ) ( 290 , 0.16666666657174645 ) ( 295 , 0.1666666667049288 ) ( 300 , 0.16666666654785445 ) ( 305 , 0.16666666678215591 ) ( 310 , 0.1666666665481209 ) ( 315 , 0.16666666639257866 ) ( 320 , 0.16666666670062114 ) ( 325 , 0.16666666639991723 ) ( 330 , 0.16666666707343403 ) ( 335 , 0.16666666689372223 ) ( 340 , 0.1666666666272576 ) ( 345 , 0.16666666710341005 ) ( 350 , 0.16666666667219943 ) ( 355 , 0.16666666666590446 ) ( 360 , 0.16666666650948514 ) ( 365 , 0.16666666672713326 ) ( 370 , 0.16666666624458593 ) ( 375 , 0.16666666684261866 ) ( 380 , 0.16666666654678863 ) ( 385 , 0.1666666665710137 ) ( 390 , 0.16666666733242685 ) ( 395 , 0.16666666641851346 ) ( 400 , 0.16666666709852507 ) ( 405 , 0.1666666667900607 ) ( 410 , 0.16666666664102436 ) ( 415 , 0.1666666666800487 ) ( 420 , 0.16666666710740685 ) ( 425 , 0.16666666681014464 ) ( 430 , 0.16666666702769284 ) ( 435 , 0.16666666633832206 ) ( 440 , 0.16666666619755688 ) ( 445 , 0.1666666670369965 ) ( 450 , 0.16666666630804627 ) ( 455 , 0.16666666693277987 ) ( 460 , 0.1666666671503947 ) ( 465 , 0.16666666706024458 ) ( 470 , 0.16666666742040093 ) ( 475 , 0.16666666649067796 ) ( 480 , 0.16666666592755064 ) ( 485 , 0.166666666222115 ) ( 490 , 0.16666666564946198 ) ( 495 , 0.1666666665535499 ) ( 500 , 0.1666666670230299 ) ( 505 , 0.16666666648463835 ) ( 510 , 0.1666666656261917 ) ( 515 , 0.1666666664650318 ) ( 520 , 0.16666666700970723 ) ( 525 , 0.16666666722980894 ) ( 530 , 0.1666666661423566 ) ( 535 , 0.16666666776056216 ) ( 540 , 0.1666666677612838 ) ( 545 , 0.16666666582948464 ) ( 550 , 0.16666666567632937 ) ( 555 , 0.16666666653336604 ) ( 560 , 0.16666666583660117 ) ( 565 , 0.16666666655237306 ) ( 570 , 0.16666666678726294 ) ( 575 , 0.1666666658700633 ) ( 580 , 0.1666666673934003 ) ( 585 , 0.1666666663530103 ) ( 590 , 0.16666666778704098 ) ( 595 , 0.1666666677085371 ) ( 600 , 0.1666666660682381 ) ( 605 , 0.16666666742136682 ) ( 610 , 0.16666666628641913 ) ( 615 , 0.1666666660064875 ) ( 620 , 0.16666666595064328 ) ( 625 , 0.1666666665789407 ) ( 630 , 0.1666666671857442 ) ( 635 , 0.16666666604324698 ) ( 640 , 0.16666666688252008 ) ( 645 , 0.16666666600129165 ) ( 650 , 0.1666666696364949 ) ( 655 , 0.1666666670612993 ) ( 660 , 0.16666666576767852 ) ( 665 , 0.16666666692353171 ) ( 670 , 0.16666666664453267 ) ( 675 , 0.16666666513898143 ) ( 680 , 0.1666666662679006 ) ( 685 , 0.1666666675163686 ) ( 690 , 0.16666666646911743 ) ( 695 , 0.16666666838728306 ) ( 700 , 0.16666666710740685 ) ( 705 , 0.16666666496791827 ) ( 710 , 0.16666666660993812 ) ( 715 , 0.16666666664758578 ) ( 720 , 0.1666666665670391 ) ( 725 , 0.16666666800030372 ) ( 730 , 0.1666666681470641 ) ( 735 , 0.1666666659959959 ) ( 740 , 0.16666666630538174 ) ( 745 , 0.16666666606267588 ) ( 750 , 0.16666666721731893 ) ( 755 , 0.16666666658916585 ) ( 760 , 0.16666666744455938 ) ( 765 , 0.16666666620372972 ) ( 770 , 0.16666666564946198 ) ( 775 , 0.16666666565190447 ) ( 780 , 0.16666666631923732 ) ( 785 , 0.16666666613773806 ) ( 790 , 0.16666666350837467 ) ( 795 , 0.16666666873080827 ) ( 800 , 0.16666666454057122 ) ( 805 , 0.16666666861866464 ) ( 810 , 0.16666666795552842 ) ( 815 , 0.16666666497288096 ) ( 820 , 0.166666666193116 ) ( 825 , 0.16666666755704718 ) ( 830 , 0.1666666658387328 ) ( 835 , 0.16666666468624358 ) ( 840 , 0.16666667133762303 ) ( 845 , 0.16666666418215792 ) ( 850 , 0.16666666384224094 ) ( 855 , 0.16666667006973723 ) ( 860 , 0.1666666659602356 ) ( 865 , 0.16666666369492544 ) ( 870 , 0.16666666810301045 ) ( 875 , 0.16666666648179618 ) ( 880 , 0.16666666894877835 ) ( 885 , 0.16666666635710703 ) ( 890 , 0.16666666510229966 ) ( 895 , 0.16666666917143358 ) ( 900 , 0.1666666652289095 ) ( 905 , 0.1666666688813101 ) ( 910 , 0.16666666665696717 ) ( 915 , 0.1666666670713357 ) ( 920 , 0.16666666527100915 ) ( 925 , 0.1666666706370834 ) ( 930 , 0.1666666651397808 ) ( 935 , 0.16666667113847122 ) ( 940 , 0.1666666638888259 ) ( 945 , 0.16666666947711128 ) ( 950 , 0.1666666694966068 ) ( 955 , 0.16666666114140138 ) ( 960 , 0.1666666671553685 ) ( 965 , 0.16666666611824255 ) ( 970 , 0.16666666872917624 ) ( 975 , 0.16666666424219878 ) ( 980 , 0.1666666662892169 ) ( 985 , 0.16666666546765185 ) ( 990 , 0.16666666557423326 ) ( 995 , 0.16666666448394984 ) ( 1000 , 0.16666666535769536 ) 
                };\label{plot_two}
        \end{axis}
    \end{tikzpicture}
    \caption{复合梯形公式下$n^2\cdot|T(h)-\pi|$关于$n$的变化图}
    \end{figure}

    \begin{figure}[!htbp]
        \centering
    \begin{tikzpicture}[]
        \begin{axis}[ xlabel=等分区间个数$n$,  ylabel=$n^4\cdot|S(h)-\pi|$] % sharp plot: 折线图，通过修改此类型，即可完成多种图形绘制
            \addplot[mark=.,blue] coordinates{
                ( 6 , 1.721659998565883e-05 ) ( 12 , 4.305726974962454e-06 ) ( 18 , 1.913651381357795e-06 ) ( 24 , 1.0764524631667882e-06 ) ( 30 , 6.87769841078989e-07 ) ( 36 , 4.773755790665746e-07 ) ( 42 , 3.523770075730681e-07 ) ( 48 , 2.68744770437479e-07 ) ( 54 , 2.114624635396467e-07 ) ( 60 , 1.8417267710901797e-07 ) ( 66 , 1.2639713276030307e-07 ) ( 72 , 9.547511581331491e-08 ) ( 78 , 4.931396091478746e-08 ) ( 84 , 6.632978966081282e-08 ) ( 90 , 8.741007917478782e-08 ) ( 96 , 3.771856427192688e-08 ) ( 102 , 1.4420893279520897e-07 ) ( 108 , 2.416713869024534e-07 ) ( 114 , 1.5000979658452707e-07 ) ( 120 , 5.525180313270539e-07 ) ( 126 , 3.357945601578649e-07 ) ( 132 , 1.348236082776566e-07 ) ( 138 , 4.831787450143565e-07 ) ( 144 , 0.0 ) ( 150 , 4.496403249731884e-07 ) ( 156 , 2.630077915455331e-07 ) ( 162 , 3.0586534904841756e-07 ) ( 168 , 2.1225532691460103e-06 ) ( 174 , 8.141364702396459e-07 ) ( 180 , 9.323741778644035e-07 ) ( 186 , 2.1260916867049673e-06 ) ( 192 , 1.2069940567016602e-06 ) ( 198 , 2.7301780676225462e-06 ) ( 204 , 1.538228616482229e-06 ) ( 210 , 8.636691362085003e-07 ) ( 216 , 9.666855476098135e-07 ) ( 222 , 5.393269510989285e-06 ) ( 228 , 2.400156745352433e-06 ) ( 234 , 5.3259077787970455e-06 ) ( 240 , 1.4733814168721437e-06 ) ( 246 , 3.2526748015015983e-06 ) ( 252 , 1.7909043208419462e-06 ) ( 258 , 0.0 ) ( 264 , 8.628710929770023e-06 ) ( 270 , 0.0 ) ( 276 , 0.0 ) ( 282 , 0.0 ) ( 288 , 6.1104074120521545e-06 ) ( 294 , 3.317871353658575e-05 ) ( 300 , 1.7985612998927536e-05 ) 
                %( 5 , 2.4781611207558285e-05 ) ( 10 , 6.200076008155975e-06 ) ( 15 , 2.755688177646931e-06 ) ( 20 , 1.5501200323342346e-06 ) ( 25 , 9.917414112159406e-07 ) ( 30 , 6.87769841078989e-07 ) ( 35 , 5.058062302332189e-07 ) ( 40 , 3.8767211663071066e-07 ) ( 45 , 3.0229319047947456e-07 ) ( 50 , 2.525757381022231e-07 ) ( 55 , 2.1537577277186415e-07 ) ( 60 , 1.8417267710901797e-07 ) ( 65 , 1.0305450937053706e-07 ) ( 70 , 1.5993872892750005e-07 ) ( 75 , 1.124100812432971e-07 ) ( 80 , 9.094947017729282e-08 ) ( 85 , 9.27269372397177e-08 ) ( 90 , 8.741007917478782e-08 ) ( 95 , 1.0851403109413127e-07 ) ( 100 , 8.881784197001252e-08 ) ( 105 , 1.0795864202606253e-07 ) ( 110 , 1.3003820242829534e-07 ) ( 115 , 3.1068592143412843e-07 ) ( 120 , 5.525180313270539e-07 ) ( 125 , 3.2526065174565133e-07 ) ( 130 , 0.0 ) ( 135 , 2.950090172149089e-07 ) ( 140 , 5.118039325680002e-07 ) ( 145 , 3.9261982553995267e-07 ) ( 150 , 4.496403249731884e-07 ) ( 155 , 1.5379714168872738e-06 ) ( 160 , 1.1641532182693481e-06 ) ( 165 , 3.2915919989662257e-07 ) ( 170 , 0.0 ) ( 175 , 4.165071065820314e-07 ) ( 180 , 9.323741778644035e-07 ) ( 185 , 5.20184173513627e-07 ) ( 190 , 5.787414991687001e-07 ) ( 195 , 3.2105443303898085e-06 ) ( 200 , 7.105427357601002e-07 ) ( 205 , 7.843062310719517e-07 ) ( 210 , 8.636691362085003e-07 ) ( 215 , 4.744539483514387e-06 ) ( 220 , 3.120916858279088e-06 ) ( 225 , 1.1381520725883831e-06 ) ( 230 , 6.213718428682569e-06 ) ( 235 , 6.771917748782386e-06 ) ( 240 , 1.4733814168721437e-06 ) ( 245 , 4.800161101936595e-06 ) ( 250 , 1.0408340855860843e-05 ) ( 255 , 1.8777204791042834e-06 ) ( 260 , 1.2176286645626533e-05 ) ( 265 , 2.1900484203918325e-06 ) ( 270 , 0.0 ) ( 275 , 0.0 ) ( 280 , 1.3648104868480004e-05 ) ( 285 , 2.9298788395415443e-06 ) ( 290 , 6.281917208639243e-06 ) ( 295 , 1.3452973179894911e-05 ) ( 300 , 1.7985612998927536e-05 ) ( 305 , 0.0 ) ( 310 , 4.101257111699397e-06 ) ( 315 , 1.3116975006166598e-05 ) ( 320 , 1.862645149230957e-05 ) ( 325 , 1.4863631159212076e-05 ) ( 330 , 5.266547198345961e-06 ) ( 335 , 3.915141738586314e-05 ) ( 340 , 5.934523983341933e-06 ) ( 345 , 3.1456949545205504e-05 ) ( 350 , 1.9992341115937506e-05 ) ( 355 , 6.347842501641665e-05 ) ( 360 , 2.2376980268745683e-05 ) ( 365 , 4.7292571525581195e-05 ) ( 370 , 4.993768065730819e-05 ) ( 375 , 2.6346112791397758e-05 ) ( 380 , 9.259863986699202e-06 ) ( 385 , 4.878464437974017e-05 ) ( 390 , 1.0273741857247387e-05 ) ( 395 , 4.324327673721484e-05 ) ( 400 , 0.00011368683772161603 ) ( 405 , 7.168719118322286e-05 ) ( 410 , 2.5097799394302456e-05 ) ( 415 , 2.6344660342125792e-05 ) ( 420 , 1.3818706179336004e-05 ) ( 425 , 5.795433577482356e-05 ) ( 430 , 7.59126317362302e-05 ) ( 435 , 1.5901102934368083e-05 ) ( 440 , 0.0 ) ( 445 , 5.224341043108538e-05 ) ( 450 , 9.105216580707065e-05 ) ( 455 , 5.710012546122911e-05 ) ( 460 , 5.965169691535266e-05 ) ( 465 , 0.00014533829889584737 ) ( 470 , 8.668054718441454e-05 ) ( 475 , 2.2607089811277348e-05 ) ( 480 , 4.71482053399086e-05 ) ( 485 , 7.37154345897828e-05 ) ( 490 , 0.00017920601447229956 ) ( 495 , 7.998568557487928e-05 ) ( 500 , 8.326672684688674e-05 ) ( 505 , 0.00017329537971289 ) ( 510 , 0.00012017411066267414 ) ( 515 , 9.371743464603455e-05 ) ( 520 , 0.0 ) ( 525 , 0.0003036336806983009 ) ( 530 , 0.00028032619781015455 ) ( 535 , 0.00010914569331665902 ) ( 540 , 0.0 ) ( 545 , 3.91792601139862e-05 ) ( 550 , 0.0 ) ( 555 , 8.426983610920757e-05 ) ( 560 , 0.00017469574231654406 ) ( 565 , 0.0 ) ( 570 , 0.0006562928600573059 ) ( 575 , 0.00024272337612041284 ) ( 580 , 0.0 ) ( 585 , 0.0002080432726092596 ) ( 590 , 0.00043049514175663717 ) ( 595 , 0.0001113186881562811 ) ( 600 , 0.0 ) ( 605 , 0.0 ) ( 610 , 0.0008608304025159441 ) ( 615 , 6.352880471682809e-05 ) ( 620 , 0.0005905810240847131 ) ( 625 , 0.00033881317890172014 ) ( 630 , 0.0 ) ( 635 , 7.220464254276138e-05 ) ( 640 , 0.00014901161193847656 ) ( 645 , 0.00038430769816466537 ) ( 650 , 0.00023781809854739322 ) ( 655 , 0.00032696059304448966 ) ( 660 , 8.426475517353538e-05 ) ( 665 , 0.00017369479243800612 ) ( 670 , 0.0007159116321986403 ) ( 675 , 9.219031787965903e-05 ) ( 680 , 0.0009495238373347092 ) ( 685 , 0.00019555210839516945 ) ( 690 , 0.00030198671563397284 ) ( 695 , 0.0 ) ( 700 , 0.0006397549157100002 ) ( 705 , 0.0002194101350605493 ) ( 710 , 0.0006771032001751109 ) ( 715 , 0.00011606315936107947 ) ( 720 , 0.0004773755790665746 ) ( 725 , 0.0007361621728874113 ) ( 730 , 0.00037834057220464956 ) ( 735 , 0.001684856546779745 ) ( 740 , 0.00039950144525846554 ) ( 745 , 0.001504831928789141 ) ( 750 , 0.00028102520310824275 ) ( 755 , 0.0012986751699028964 ) ( 760 , 0.0004444734713615617 ) ( 765 , 0.0022814303821117043 ) ( 770 , 0.0003122217240303371 ) ( 775 , 0.0006408214237030307 ) ( 780 , 0.0001643798697159582 ) ( 785 , 0.0011804480745669643 ) ( 790 , 0.0012108117486420156 ) ( 795 , 0.0010643635323104306 ) ( 800 , 0.0023646862246096134 ) ( 805 , 0.0001864892243408356 ) ( 810 , 0.0009558292157763049 ) ( 815 , 0.000587789617811918 ) ( 820 , 0.0012046943709265179 ) ( 825 , 0.0002057244999353891 ) ( 830 , 0.00021075728273700634 ) ( 835 , 0.0004317636920214696 ) ( 840 , 0.0008843971954775043 ) ( 845 , 0.0011320537854353496 ) ( 850 , 0.0004636346861985885 ) ( 855 , 0.0011866009300143254 ) ( 860 , 0.00048584084311187326 ) ( 865 , 0.0017403343452460085 ) ( 870 , 0.0 ) ( 875 , 0.001301584708068848 ) ( 880 , 0.0010652729542925954 ) ( 885 , 0.0016345362413572317 ) ( 890 , 0.0036222097898885863 ) ( 895 , 0.0008548376015382608 ) ( 900 , 0.003205036236408887 ) ( 905 , 0.0029789590821893697 ) ( 910 , 0.001522670012299443 ) ( 915 , 0.0021789769563684835 ) ( 920 , 0.0003181423835485475 ) ( 925 , 0.0009753453253380506 ) ( 930 , 0.0 ) ( 935 , 0.0 ) ( 940 , 0.002773777509901265 ) ( 945 , 0.00035415832516649814 ) ( 950 , 0.0010851403109413127 ) ( 955 , 0.0003693887865030554 ) ( 960 , 0.0003771856427192688 ) ( 965 , 0.0007702105625506661 ) ( 970 , 0.0003931489844788416 ) ( 975 , 0.0024079082477923563 ) ( 980 , 0.00040961374736525613 ) ( 985 , 0.0016721496198801589 ) ( 990 , 0.00597226452292432 ) ( 995 , 0.003046916720872428 ) ( 1000 , 0.0017763568394002505 ) 
            };\label{plot_thr}
        \end{axis}
    \end{tikzpicture}
    \caption{复合Simpson公式下$n^4\cdot|S(h)-\pi|$关于$n$的变化图}
    \end{figure}

    \begin{figure}[!htbp]
        \centering
    \begin{tikzpicture}[]
        \begin{axis}[ xlabel=等分区间个数$n$,  ylabel=$n^4\cdot|R_2(f)-\pi|$] % sharp plot: 折线图，通过修改此类型，即可完成多种图形绘制
            \addplot[mark=.,blue] coordinates{
                ( 6 , 1.721659998565883e-05 ) ( 12 , 4.305726974962454e-06 ) ( 18 , 1.9135581439400084e-06 ) ( 24 , 1.0757157724583521e-06 ) ( 30 , 6.87769841078989e-07 ) ( 36 , 4.773755790665746e-07 ) ( 42 , 3.551407488089353e-07 ) ( 48 , 2.8053182177245617e-07 ) ( 54 , 2.227908098006992e-07 ) ( 60 , 1.6115109247039072e-07 ) ( 66 , 1.6010303482971722e-07 ) ( 72 , 1.5514706319663674e-07 ) ( 78 , 1.1506590880117074e-07 ) ( 84 , 2.2109929886937607e-08 ) ( 90 , 1.1654677223305043e-07 ) ( 96 , 2.6402994990348816e-07 ) ( 102 , 1.4420893279520897e-07 ) ( 108 , 1.8125354017684003e-07 ) ( 114 , 7.500489829226353e-08 ) ( 120 , 2.7625901566352695e-07 ) ( 126 , 0.0 ) ( 132 , 1.2134124744989094e-06 ) ( 138 , 1.1274170717001653e-06 ) ( 144 , 1.9095023162662983e-07 ) ( 150 , 8.992806499463768e-07 ) ( 156 , 0.0 ) ( 162 , 9.175960471452527e-07 ) ( 168 , 3.537588781910017e-07 ) ( 174 , 3.2565458809585834e-06 ) ( 180 , 1.864748355728807e-06 ) ( 186 , 0.0 ) ( 192 , 0.0 ) ( 198 , 6.825445169056366e-07 ) ( 204 , 7.691143082411145e-07 ) ( 210 , 6.909353089668002e-06 ) ( 216 , 2.9000566428294405e-06 ) ( 222 , 4.314615608791428e-06 ) ( 228 , 1.3200862099438382e-05 ) ( 234 , 3.994430834097784e-06 ) ( 240 , 1.620719558559358e-05 ) ( 246 , 8.131687003753996e-06 ) ( 252 , 1.6118138887577516e-05 ) ( 258 , 1.9676554146030867e-06 ) ( 264 , 0.0 ) ( 270 , 2.8320865652631255e-05 ) ( 276 , 1.030781322697294e-05 ) ( 282 , 2.2467597830200248e-05 ) ( 288 , 3.0552037060260773e-06 ) ( 294 , 4.976807030487862e-05 ) ( 300 , 1.4388490399142029e-05 ) 
                %( 5 , 2.478161148511404e-05 ) ( 10 , 6.200067126371778e-06 ) ( 15 , 2.7557331416794284e-06 ) ( 20 , 1.5503331951549626e-06 ) ( 25 , 9.922618282587337e-07 ) ( 30 , 6.87769841078989e-07 ) ( 35 , 5.064726416037502e-07 ) ( 40 , 3.83124643121846e-07 ) ( 45 , 3.1321945037632304e-07 ) ( 50 , 2.3037127760971998e-07 ) ( 55 , 1.9099360981655877e-07 ) ( 60 , 1.6115109247039072e-07 ) ( 65 , 1.506181290800157e-07 ) ( 70 , 1.5993872892750005e-07 ) ( 75 , 1.2646134139870924e-07 ) ( 80 , 1.8189894035458565e-08 ) ( 85 , 1.1590867154964712e-07 ) ( 90 , 1.1654677223305043e-07 ) ( 95 , 1.8085671849021878e-07 ) ( 100 , 2.220446049250313e-07 ) ( 105 , 1.619379630390938e-07 ) ( 110 , 5.201528097131813e-07 ) ( 115 , 3.8835740179266054e-07 ) ( 120 , 2.7625901566352695e-07 ) ( 125 , 1.0842021724855044e-07 ) ( 130 , 0.0 ) ( 135 , 5.900180344298178e-07 ) ( 140 , 5.118039325680002e-07 ) ( 145 , 5.88929738309929e-07 ) ( 150 , 8.992806499463768e-07 ) ( 155 , 7.689857084436369e-07 ) ( 160 , 8.731149137020111e-07 ) ( 165 , 4.279069598656093e-06 ) ( 170 , 3.709077489588708e-07 ) ( 175 , 4.165071065820314e-07 ) ( 180 , 1.864748355728807e-06 ) ( 185 , 4.161473388109016e-06 ) ( 190 , 1.7362244975061003e-06 ) ( 195 , 7.70530639293554e-06 ) ( 200 , 5.6843418860808015e-06 ) ( 205 , 7.843062310719517e-07 ) ( 210 , 6.909353089668002e-06 ) ( 215 , 4.744539483514387e-06 ) ( 220 , 8.322444955410901e-06 ) ( 225 , 5.690760362941916e-06 ) ( 230 , 6.213718428682569e-06 ) ( 235 , 1.6252602597077725e-05 ) ( 240 , 1.620719558559358e-05 ) ( 245 , 2.0800698108391913e-05 ) ( 250 , 6.938893903907228e-06 ) ( 255 , 2.25326457492514e-05 ) ( 260 , 8.117524430417689e-06 ) ( 265 , 1.0950242101959162e-05 ) ( 270 , 2.8320865652631255e-05 ) ( 275 , 2.7937895052954076e-05 ) ( 280 , 2.1836967789568007e-05 ) ( 285 , 0.0 ) ( 290 , 2.512766883455697e-05 ) ( 295 , 3.026918965476355e-05 ) ( 300 , 1.4388490399142029e-05 ) ( 305 , 1.5371971473499002e-05 ) ( 310 , 2.0506285558496984e-05 ) ( 315 , 2.1861625010277663e-05 ) ( 320 , 4.656612873077393e-06 ) ( 325 , 0.00011395450555395925 ) ( 330 , 4.739892478511365e-05 ) ( 335 , 5.593059626551877e-06 ) ( 340 , 1.7803571950025798e-05 ) ( 345 , 2.5165559636164403e-05 ) ( 350 , 1.9992341115937506e-05 ) ( 355 , 0.0 ) ( 360 , 0.0 ) ( 365 , 6.305676203410826e-05 ) ( 370 , 0.0 ) ( 375 , 2.6346112791397758e-05 ) ( 380 , 4.629931993349601e-05 ) ( 385 , 4.878464437974017e-05 ) ( 390 , 5.1368709286236935e-05 ) ( 395 , 0.00014054064939594824 ) ( 400 , 0.00013642420526593924 ) ( 405 , 5.9739325986019054e-05 ) ( 410 , 3.7646699091453684e-05 ) ( 415 , 5.2689320684251584e-05 ) ( 420 , 0.0002625554174073841 ) ( 425 , 0.00017386300732447069 ) ( 430 , 6.073010538898416e-05 ) ( 435 , 0.00011130772054057658 ) ( 440 , 0.00018309378901903983 ) ( 445 , 0.000139315761149561 ) ( 450 , 7.284173264565652e-05 ) ( 455 , 1.9033375153743037e-05 ) ( 460 , 0.00013918729280248954 ) ( 465 , 0.00014533829889584737 ) ( 470 , 0.0002600416415532436 ) ( 475 , 0.0002486779879240508 ) ( 480 , 9.42964106798172e-05 ) ( 485 , 0.0001965744922394208 ) ( 490 , 7.680257763098552e-05 ) ( 495 , 7.998568557487928e-05 ) ( 500 , 0.00013877787807814457 ) ( 505 , 0.00014441281642740833 ) ( 510 , 9.01305829970056e-05 ) ( 515 , 3.1239144882011516e-05 ) ( 520 , 0.0003571710749383783 ) ( 525 , 0.00010121122689943363 ) ( 530 , 0.00010512232417880796 ) ( 535 , 3.6381897772219673e-05 ) ( 540 , 0.0004531338504421001 ) ( 545 , 0.0005093303814818206 ) ( 550 , 0.00036573244432958063 ) ( 555 , 0.0003370793444368303 ) ( 560 , 0.00017469574231654406 ) ( 565 , 0.00031678313500149713 ) ( 570 , 0.00018751224573065883 ) ( 575 , 0.0001456340256722477 ) ( 580 , 0.0002512766883455697 ) ( 585 , 0.0 ) ( 590 , 0.0008071783907936947 ) ( 595 , 0.00027829672039070275 ) ( 600 , 0.00017266188478970435 ) ( 605 , 0.000297482706523855 ) ( 610 , 0.0010452940601979321 ) ( 615 , 0.0 ) ( 620 , 0.0010499218205950456 ) ( 625 , 0.0006098637220230962 ) ( 630 , 0.0009094436004275508 ) ( 635 , 0.0008664557105131365 ) ( 640 , 0.001862645149230957 ) ( 645 , 0.00023058461889879922 ) ( 650 , 0.0006341815961263819 ) ( 655 , 0.00032696059304448966 ) ( 660 , 0.0003370590206941415 ) ( 665 , 0.0004342369810950153 ) ( 670 , 0.0006264226781738103 ) ( 675 , 0.0011062838145559084 ) ( 680 , 9.495238373347092e-05 ) ( 685 , 0.001466640812963771 ) ( 690 , 0.0019125825323484946 ) ( 695 , 0.0017614014960476432 ) ( 700 , 0.0020258905664150006 ) ( 705 , 0.0007679354727119225 ) ( 710 , 0.0 ) ( 715 , 0.0003481894780832384 ) ( 720 , 0.0009547511581331491 ) ( 725 , 0.0 ) ( 730 , 0.00012611352406821652 ) ( 735 , 0.0011664391477705927 ) ( 740 , 0.0027965101168092588 ) ( 745 , 0.0027360580523438927 ) ( 750 , 0.0018266638202035779 ) ( 755 , 0.00014429724110032183 ) ( 760 , 0.0022223673568078084 ) ( 765 , 0.0010646675116521287 ) ( 770 , 0.0 ) ( 775 , 0.0017622589151833346 ) ( 780 , 0.0011506590880117074 ) ( 785 , 0.0008431771961192602 ) ( 790 , 0.0012108117486420156 ) ( 795 , 0.0 ) ( 800 , 0.0 ) ( 805 , 0.000932446121704178 ) ( 810 , 0.0005734975294657829 ) ( 815 , 0.0025470883438516445 ) ( 820 , 0.0016062591612353572 ) ( 825 , 0.0010286224996769455 ) ( 830 , 0.0035828738065291077 ) ( 835 , 0.0015111729220751435 ) ( 840 , 0.0006632978966081282 ) ( 845 , 0.002490518327957769 ) ( 850 , 0.0006954520292978827 ) ( 855 , 0.004983723906060167 ) ( 860 , 0.004129647166450923 ) ( 865 , 0.0027348111139580134 ) ( 870 , 0.004070682351198229 ) ( 875 , 0.001301584708068848 ) ( 880 , 0.005326364771462977 ) ( 885 , 0.0010896908275714878 ) ( 890 , 0.000278631522299122 ) ( 895 , 0.001994621070255942 ) ( 900 , 0.003496403166991513 ) ( 905 , 0.005660022256159802 ) ( 910 , 0.0048725440393582176 ) ( 915 , 0.002801541801045193 ) ( 920 , 0.0 ) ( 925 , 0.009103223036488473 ) ( 930 , 0.0016610091302382557 ) ( 935 , 0.004412249036411797 ) ( 940 , 0.002773777509901265 ) ( 945 , 0.002479108276165487 ) ( 950 , 0.0054257015547065635 ) ( 955 , 0.0 ) ( 960 , 0.0011315569281578064 ) ( 965 , 0.004621263375303997 ) ( 970 , 0.005897234767182624 ) ( 975 , 0.006421088660779617 ) ( 980 , 0.014336481157783965 ) ( 985 , 0.0037623366447303574 ) ( 990 , 0.00298613226146216 ) ( 995 , 0.0065291072590123456 ) ( 1000 , 0.0 ) 
                };\label{plot_fou}
        \end{axis}
    \end{tikzpicture}
    \caption{Romberg求积方法$k=2$下$n^4\cdot|R_2(f)-\pi|$关于$n$的变化图}
    \end{figure}

    \begin{figure}[!htbp]
        \centering
    \begin{tikzpicture}[]
        \begin{axis}[ xlabel=等分区间个数$n$,  ylabel=$n^6\cdot|R_3(f)-\pi|$] % sharp plot: 折线图，通过修改此类型，即可完成多种图形绘制
            \addplot[mark=.,blue] coordinates{
                ( 6 , 3.0986088319195915e-05 ) ( 12 , 3.100819594692439e-05 ) ( 18 , 3.102456429360245e-05 ) ( 24 , 3.055203706026077e-05 ) ( 30 , 3.1726621330108173e-05 ) ( 36 , 2.8033880880684592e-05 ) ( 42 , 4.143953609059281e-05 ) ( 48 , 8.147209882736206e-05 ) ( 54 , 7.707806796020122e-05 ) ( 60 , 4.143885234952904e-05 ) ( 66 , 0.0004037630008895121 ) ( 72 , 0.00012373575009405613 ) ( 78 , 0.00010000871273518896 ) ( 84 , 0.0003120153305644635 ) ( 90 , 0.0011800360688596356 ) ( 96 , 0.0003476142883300781 ) ( 102 , 0.0010002331578675694 ) ( 108 , 0.002114141292622662 ) ( 114 , 0.010722400240268826 ) ( 120 , 0.015912519302219152 ) ( 126 , 0.01599322331119879 ) ( 132 , 0.0023491665506298887 ) ( 138 , 0.015336093366755676 ) ( 144 , 0.003959544003009796 ) ( 150 , 0.020233814623793478 ) ( 156 , 0.03840334569031256 ) ( 162 , 0.11237982308597338 ) ( 168 , 0.03993796231225133 ) ( 174 , 0.061621989432438795 ) ( 180 , 0.015104461681403336 ) ( 186 , 0.16549710298480136 ) ( 192 , 0.13348388671875 ) ( 198 , 0.24082627716691718 ) ( 204 , 0.1600373052588111 ) ( 210 , 0.7617561781358972 ) ( 216 , 0.5412201709114015 ) ( 222 , 0.2658018945795959 ) ( 228 , 0.3119243706260022 ) ( 234 , 0.583250812671622 ) ( 240 , 0.4243338480591774 ) ( 246 , 0.8857749072945182 ) ( 252 , 0.11372958799074695 ) ( 258 , 0.2619500300352797 ) ( 264 , 2.7062398663256317 ) ( 270 , 2.2366403649165534 ) ( 276 , 2.355623941133672 ) ( 282 , 0.8933566249244222 ) ( 288 , 1.2670540809631348 ) ( 294 , 1.1471341132993302 ) ( 300 , 1.2949641359227826 ) 
                };\label{plot_fiv}
        \end{axis}
    \end{tikzpicture}
    \caption{Romberg求积方法$k=3$下$n^6\cdot|R_3(f)-\pi|$关于$n$的变化图}
    \end{figure}

    \begin{figure}[!htbp]
        \centering
    \begin{tikzpicture}[]
        \begin{axis}[ xlabel=等分区间个数$n$,xmin=0,xmax=90,xtick={0,20,40,60,80},  ylabel=$n^8\cdot|R_4(f)-\pi|$] % sharp plot: 折线图，通过修改此类型，即可完成多种图形绘制
            \addplot[mark=.,blue] coordinates{
                %( 6 , 1.2680288818955887e-08 ) ( 12 , 1.145701389759779e-06 ) ( 18 , 1.4681536754324043e-05 ) ( 24 , 0.0004888325929641724 ) ( 30 , 0.0011654677223305043 ) ( 36 , 0.0012528244697023183 ) ( 42 , 0.004299961274341513 ) ( 48 , 0.025028228759765625 ) ( 54 , 0.09632556264512004 ) ( 60 , 0.9696691449789796 ) ( 66 , 0.3197802967044936 ) ( 72 , 0.3207230642437935 ) ( 78 , 3.650718049685338 ) ( 84 , 4.403160344925709 ) ( 90 , 1.9116584315526097 ) %( 96 , 19.2216796875 ) ( 102 , 26.01606443613548 ) ( 108 , 106.85715749431984 ) ( 114 , 50.67211400819406 ) ( 120 , 114.5701389759779 ) ( 126 , 28.212045920954665 ) ( 132 , 736.7738036071532 ) ( 138 , 700.9453489835882 ) ( 144 , 410.52552223205566 ) ( 150 , 455.26082903535325 ) ( 156 , 934.5838207194465 ) ( 162 , 2949.2960770682857 ) ( 168 , 1127.2090483009815 ) ( 174 , 373.1334704113034 ) ( 180 , 4404.461026297213 ) ( 186 , 2544.6834554943057 ) ( 192 , 3280.5 ) ( 198 , 4196.1570533563645 ) ( 204 , 1332.0224991301366 ) ( 210 , 8398.361863948267 ) ( 216 , 8417.056098014116 ) ( 222 , 57639.03451882754 ) ( 228 , 84318.39770963491 ) ( 234 , 15968.240749323668 ) ( 240 , 14664.97778892517 ) ( 246 , 47647.603813186724 ) ( 252 , 130001.1076037591 ) ( 258 , 104618.65079561016 ) ( 264 , 52392.80381206423 ) ( 270 , 62711.95484708336 ) ( 276 , 44860.50233494965 ) ( 282 , 88804.11530061219 ) ( 288 , 336302.5078125 ) ( 294 , 223095.78948856704 ) ( 300 , 874100.7917478783 ) 
                ( 2 , 3.889407253154786e-06 ) ( 4 , 1.5425030142068863e-08 ) ( 6 , 1.2680288818955887e-08 ) ( 8 , 1.4901161193847656e-08 ) ( 10 , 1.7763568394002505e-07 ) ( 12 , 1.145701389759779e-06 ) ( 14 , 1.9661459873532294e-06 ) ( 16 , 1.9073486328125e-06 ) ( 18 , 1.4681536754324043e-05 ) ( 20 , 5.6843418860808015e-05 ) ( 22 , 4.87395666368684e-05 ) ( 24 , 0.0004888325929641724 ) ( 26 , 0.0 ) ( 28 , 0.0006711111636832356 ) ( 30 , 0.0011654677223305043 ) ( 32 , 0.00341796875 ) ( 34 , 0.0023791554125409675 ) ( 36 , 0.0012528244697023183 ) ( 38 , 0.0 ) ( 40 , 0.011641532182693481 ) ( 42 , 0.004299961274341513 ) ( 44 , 0.049909316236153245 ) ( 46 , 0.05341756965276545 ) ( 48 , 0.025028228759765625 ) ( 50 , 0.13877787807814457 ) ( 52 , 0.023740888602333143 ) ( 54 , 0.09632556264512004 ) ( 56 , 0.2577066868543625 ) ( 58 , 0.3981000293978241 ) ( 60 , 0.9696691449789796 ) ( 62 , 0.67873739477443 ) ( 64 , 0.125 ) ( 66 , 0.3197802967044936 ) ( 68 , 0.6090637856104877 ) ( 70 , 2.3040773289295657 ) ( 72 , 0.3207230642437935 ) ( 74 , 1.1979680450352816 ) ( 76 , 10.874308264523279 ) ( 78 , 3.650718049685338 ) ( 80 , 0.7450580596923828 ) ( 82 , 3.6311235949692673 ) ( 84 , 4.403160344925709 ) ( 86 , 9.301561697521606 ) %( 88 , 15.970981195569038 ) ( 90 , 1.9116584315526097 ) %( 92 , 27.34979566221591 ) ( 94 , 29.777328709243534 ) ( 96 , 19.2216796875 ) ( 98 , 7.556293569359923 ) ( 100 , 62.172489379008766 ) 
                };\label{plot_six}
        \end{axis}
    \end{tikzpicture}
    \caption{Romberg求积方法$k=4$下$n^8\cdot|R_4(f)-\pi|$关于$n$的变化图}
    \end{figure}

    \begin{table}[]
    \begin{center}
    \begin{tabular}{ccccccc}\hline
    误差阈值$\varepsilon$ & $10^{-1}$ & $10^{-2}$ & $10^{-3}$ & $10^{-4}$ & $10^{-5}$ & $10^{-6}$ \\
    计算误差 & 2.403E-05 & 2.403E-05 & 2.403E-05 & 1.511E-07 & 8.180E-07 & 9.849E-08 \\
    \hline
    误差阈值$\varepsilon$ & $10^{-7}$ & $10^{-8}$ & $10^{-9}$ & $10^{-10}$ & $10^{-11}$ & $10^{-12}$ \\
    计算误差 & 1.155E-09 & 1.605E-09 & 1.027E-10 & 1.507E-11 & 8.074E-13 & 5.818E-14\\
    \hline
    \end{tabular}
    \end{center}
    \caption{自适应方法在不同误差阈值下得到的真实计算误差}
    \end{table}
\end{section}
\newpage
\begin{section}{简明分析}
    \begin{itemize}
        \item 由图可知, 中点公式、梯形公式在$n\leq 1000$时, 误差与$n^2$的乘积均几乎不变, 保持$O(1)$, 验证了它们的收敛阶$O(h^2)$;
        \item 由图可知, Simpson公式在$n\leq 200$时, 误差与$n^4$的乘积均几乎不变, 保持$O(1)$, 验证了它的收敛阶$O(h^4)$; 但其在后面产生波动上升, 可能是因为$h^4$此时已达到接近$10^{-10}$, 
        而其误差估计$\frac{f^{(4)}(\xi)}{2880}h^4$, 其误差要保持在约$10^{-13}$左右, 才能保证误差与$n^4$的乘积保持几乎不变. 但$10^{-13}$过小, 受舍入误差影响较大, 可能因此导致了后面图像的波动.
        \item 由图可知, $k=2,3$时, Romberg求积方法下误差与$n^{2k}$的乘积在$n\leq 200$时均近似不变, 大致为$O(1)$; $k=4$时, 在$n\leq 60$时, 误差与$n^{2k}$的乘积近似不变, 保持在$O(1)$, 因此验证了Romberg求积方法收敛阶$O(h^{2k})$. 
        其在后面的波动原因与上一条类似;
        \item 从上述数值积分的计算可以看出, 复合积分并非取的区间长度越短越好, 取的足够小后, 舍入误差的影响可能导致其收敛效果不会按照其理论上的收敛阶收敛, 精度不会有明显的改善;
        \item 自适应方法在不同误差阈值下, 在不是很特殊的情况下, 其真实计算误差均略小于给定阈值, 验证了近似误差的合理性, 同时也说明该自适应方法没有为达到误差要求而过多加细, 因此不会因此进行过多不必要的区间加细, 能够有较好的计算效率.
    \end{itemize}
    

\end{section}
\end{document}